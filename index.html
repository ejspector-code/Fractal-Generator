<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fractal Generator ‚Äî Strange Attractors</title>
  <meta name="description"
    content="Advanced real-time fractal animation generator powered by Peter de Jong and Lorenz attractors with particle, vapor, and classic render modes." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="/src/styles.css" />
</head>

<body>
  <div id="app">
    <!-- Canvas Area -->
    <main id="canvas-area">
      <div id="canvas-stage">
        <div id="canvas-container"></div>
        <canvas id="midi-keyboard-viz" style="display:none;"></canvas>
        <div id="voice-mode-bar" style="display:none;">
          <span class="voice-mode-label">Voice</span>
          <label class="voice-mode-opt"><input type="radio" name="voice-mode" value="synth" /><span>Synth</span></label>
          <label class="voice-mode-opt"><input type="radio" name="voice-mode" value="bass" /><span>Bass</span></label>
          <label class="voice-mode-opt"><input type="radio" name="voice-mode" value="both"
              checked /><span>Both</span></label>
        </div>
        <canvas id="guitar-fretboard-viz" style="display:none;"></canvas>

        <!-- Guitar Pedalboard Drawer -->
        <div id="guitar-effects-drawer" style="display:none;">
          <button id="guitar-drawer-toggle" class="midi-drawer-handle guitar-drawer-handle"
            aria-label="Toggle guitar pedalboard">
            <span class="midi-drawer-handle-bar"></span>
            <span class="drawer-label">üé∏ PEDALBOARD</span>
            <span class="midi-drawer-handle-bar"></span>
          </button>
          <div id="guitar-drawer-content" class="midi-drawer-content">

            <!-- Controls Row -->
            <div class="guitar-controls-row">
              <div class="midi-fx-control">
                <label for="guitar-tuning">Tuning</label>
                <select id="guitar-tuning">
                  <option value="standard" selected>Standard</option>
                  <option value="dropD">Drop D</option>
                  <option value="openG">Open G</option>
                  <option value="dadgad">DADGAD</option>
                </select>
              </div>
              <div class="midi-fx-control">
                <label for="guitar-chord">Chord</label>
                <select id="guitar-chord">
                  <option value="None">None (Open)</option>
                  <option value="C">C</option>
                  <option value="D">D</option>
                  <option value="E">E</option>
                  <option value="F">F</option>
                  <option value="G">G</option>
                  <option value="A">A</option>
                  <option value="Am">Am</option>
                  <option value="Bm">Bm</option>
                  <option value="Dm">Dm</option>
                  <option value="Em">Em</option>
                  <option value="A7">A7</option>
                  <option value="D7">D7</option>
                </select>
              </div>
              <div class="guitar-strum-controls">
                <button id="guitar-strum-down" class="midi-looper-btn guitar-strum-btn" title="Strum Down">‚Üì
                  Strum</button>
                <button id="guitar-strum-up" class="midi-looper-btn guitar-strum-btn" title="Strum Up">‚Üë Strum</button>
              </div>
              <div class="midi-fx-control">
                <label for="guitar-riff">Riff</label>
                <select id="guitar-riff">
                  <option value="none">None</option>
                  <option value="blues_shuffle">Blues Shuffle</option>
                  <option value="smoke_water">Smoke on the Water</option>
                  <option value="sunshine">Sunshine of Your Love</option>
                  <option value="fingerpick_em">Em Fingerpick</option>
                  <option value="power_chord">Power Chord Punk</option>
                  <option value="spanish">Spanish Romance</option>
                  <option value="redemption">Reggae Skank</option>
                  <option value="walking_bass">Walking Bass</option>
                </select>
              </div>
              <div class="guitar-strum-controls">
                <button id="guitar-riff-play" class="midi-looper-btn guitar-strum-btn" title="Play Riff">‚ñ∂ Play</button>
                <button id="guitar-riff-stop" class="midi-looper-btn guitar-strum-btn" title="Stop Riff" disabled>‚èπ
                  Stop</button>
              </div>
              <div class="midi-fx-control">
                <label for="guitar-volume">Vol <span class="fx-val" id="guitar-vol-val">0.60</span></label>
                <input type="range" id="guitar-volume" min="0" max="1" step="0.01" value="0.6" />
              </div>
            </div>

            <!-- Pedals Row -->
            <div class="guitar-pedals-row">

              <!-- Overdrive -->
              <div class="guitar-pedal" data-pedal="overdrive">
                <div class="pedal-header">
                  <span class="pedal-led on" id="pedal-led-overdrive"></span>
                  <span class="pedal-name">üî• Overdrive</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-overdrive" checked />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Drive <span class="fx-val" id="pedal-val-overdrive-drive">2.0</span></label>
                    <input type="range" id="pedal-overdrive-drive" min="0.5" max="8" step="0.1" value="2.0" />
                  </div>
                  <div class="pedal-knob">
                    <label>Tone <span class="fx-val" id="pedal-val-overdrive-tone">3000</span></label>
                    <input type="range" id="pedal-overdrive-tone" min="500" max="8000" step="50" value="3000" />
                  </div>
                </div>
              </div>

              <!-- Chorus -->
              <div class="guitar-pedal" data-pedal="chorus">
                <div class="pedal-header">
                  <span class="pedal-led" id="pedal-led-chorus"></span>
                  <span class="pedal-name">üåä Chorus</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-chorus" />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Rate <span class="fx-val" id="pedal-val-chorus-rate">1.5</span></label>
                    <input type="range" id="pedal-chorus-rate" min="0.1" max="5" step="0.1" value="1.5" />
                  </div>
                  <div class="pedal-knob">
                    <label>Depth <span class="fx-val" id="pedal-val-chorus-depth">0.004</span></label>
                    <input type="range" id="pedal-chorus-depth" min="0.001" max="0.01" step="0.001" value="0.004" />
                  </div>
                </div>
              </div>

              <!-- Phaser -->
              <div class="guitar-pedal" data-pedal="phaser">
                <div class="pedal-header">
                  <span class="pedal-led" id="pedal-led-phaser"></span>
                  <span class="pedal-name">üåÄ Phaser</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-phaser" />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Rate <span class="fx-val" id="pedal-val-phaser-rate">0.5</span></label>
                    <input type="range" id="pedal-phaser-rate" min="0.1" max="5" step="0.1" value="0.5" />
                  </div>
                  <div class="pedal-knob">
                    <label>Depth <span class="fx-val" id="pedal-val-phaser-depth">1500</span></label>
                    <input type="range" id="pedal-phaser-depth" min="200" max="5000" step="100" value="1500" />
                  </div>
                </div>
              </div>

              <!-- Delay -->
              <div class="guitar-pedal" data-pedal="delay">
                <div class="pedal-header">
                  <span class="pedal-led" id="pedal-led-delay"></span>
                  <span class="pedal-name">‚è± Delay</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-delay" />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Time <span class="fx-val" id="pedal-val-delay-time">0.35</span></label>
                    <input type="range" id="pedal-delay-time" min="0.05" max="1.5" step="0.01" value="0.35" />
                  </div>
                  <div class="pedal-knob">
                    <label>Fdbk <span class="fx-val" id="pedal-val-delay-feedback">0.40</span></label>
                    <input type="range" id="pedal-delay-feedback" min="0" max="0.9" step="0.01" value="0.4" />
                  </div>
                  <div class="pedal-knob">
                    <label>Mix <span class="fx-val" id="pedal-val-delay-mix">0.30</span></label>
                    <input type="range" id="pedal-delay-mix" min="0" max="1" step="0.01" value="0.3" />
                  </div>
                </div>
              </div>

              <!-- Reverb -->
              <div class="guitar-pedal" data-pedal="reverb">
                <div class="pedal-header">
                  <span class="pedal-led" id="pedal-led-reverb"></span>
                  <span class="pedal-name">üèõ Reverb</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-reverb" />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Decay <span class="fx-val" id="pedal-val-reverb-decay">2.0</span></label>
                    <input type="range" id="pedal-reverb-decay" min="0.3" max="6" step="0.1" value="2.0" />
                  </div>
                  <div class="pedal-knob">
                    <label>Mix <span class="fx-val" id="pedal-val-reverb-mix">0.30</span></label>
                    <input type="range" id="pedal-reverb-mix" min="0" max="1" step="0.01" value="0.3" />
                  </div>
                </div>
              </div>

              <!-- Tremolo -->
              <div class="guitar-pedal" data-pedal="tremolo">
                <div class="pedal-header">
                  <span class="pedal-led" id="pedal-led-tremolo"></span>
                  <span class="pedal-name">„Ä∞ Tremolo</span>
                </div>
                <label class="pedal-toggle">
                  <input type="checkbox" id="pedal-toggle-tremolo" />
                  <span class="pedal-switch"></span>
                </label>
                <div class="pedal-knobs">
                  <div class="pedal-knob">
                    <label>Rate <span class="fx-val" id="pedal-val-tremolo-rate">5.0</span></label>
                    <input type="range" id="pedal-tremolo-rate" min="0.5" max="15" step="0.1" value="5.0" />
                  </div>
                  <div class="pedal-knob">
                    <label>Depth <span class="fx-val" id="pedal-val-tremolo-depth">0.60</span></label>
                    <input type="range" id="pedal-tremolo-depth" min="0" max="1" step="0.01" value="0.6" />
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- Drum Machine Drawer -->
        <div id="drum-effects-drawer" style="display:none;">
          <button id="drum-drawer-toggle" class="midi-drawer-handle drum-drawer-handle"
            aria-label="Toggle drum machine">
            <span class="midi-drawer-handle-bar"></span>
            <span class="drawer-label">ü•Å DRUM MACHINE</span>
            <span class="midi-drawer-handle-bar"></span>
          </button>
          <div id="drum-drawer-content" class="midi-drawer-content">

            <!-- Controls Row -->
            <div class="drum-controls-top">
              <div class="drum-transport">
                <button id="drum-play" class="midi-looper-btn drum-play-btn" title="Play">‚ñ∂</button>
                <button id="drum-stop" class="midi-looper-btn drum-stop-btn" title="Stop" disabled>‚èπ</button>
                <button id="drum-clear" class="midi-looper-btn drum-clear-btn" title="Clear">‚úï</button>
              </div>
              <div class="midi-fx-control">
                <label for="drum-bpm">Tempo <span class="fx-val" id="drum-bpm-val">120</span></label>
                <input type="range" id="drum-bpm" min="40" max="240" step="1" value="120" />
              </div>
              <div class="midi-fx-control">
                <label for="drum-volume">Vol <span class="fx-val" id="drum-vol-val">0.70</span></label>
                <input type="range" id="drum-volume" min="0" max="1" step="0.01" value="0.7" />
              </div>
              <div class="midi-fx-control">
                <label for="drum-swing">Swing <span class="fx-val" id="drum-swing-val">0%</span></label>
                <input type="range" id="drum-swing" min="0" max="1" step="0.01" value="0" />
              </div>
              <div class="midi-fx-control">
                <label for="drum-preset">Preset</label>
                <select id="drum-preset">
                  <option value="">‚Äî Custom ‚Äî</option>
                  <option value="rock">Rock</option>
                  <option value="funk">Funk</option>
                  <option value="bossa">Bossa Nova</option>
                  <option value="trap">Trap</option>
                  <option value="breakbeat">Breakbeat</option>
                  <option value="eightOhEight">808</option>
                </select>
              </div>
              <div class="drum-step-toggle">
                <button id="drum-steps-16" class="midi-looper-btn drum-step-btn active" title="16 Steps">16</button>
                <button id="drum-steps-32" class="midi-looper-btn drum-step-btn" title="32 Steps">32</button>
              </div>
            </div>

            <!-- Step Sequencer Grid (built dynamically in JS) -->
            <div class="drum-grid" id="drum-grid"></div>

          </div>
        </div>
        <!-- Bass Synth Drawer -->
        <div id="bass-effects-drawer" style="display:none;">
          <button id="bass-drawer-toggle" class="midi-drawer-handle drum-drawer-handle" aria-label="Toggle bass synth">
            <span class="midi-drawer-handle-bar"></span>
            <span class="drawer-label">üéõÔ∏è BASS SYNTH</span>
            <span class="midi-drawer-handle-bar"></span>
          </button>
          <div id="bass-drawer-content" class="midi-drawer-content">
            <div class="drum-controls-top bass-controls">
              <div class="midi-fx-control">
                <label for="bass-wave">Wave</label>
                <select id="bass-wave">
                  <option value="sawtooth">Saw</option>
                  <option value="square">Square</option>
                  <option value="triangle">Tri</option>
                </select>
              </div>
              <div class="midi-fx-control">
                <label for="bass-sub-wave">Sub</label>
                <select id="bass-sub-wave">
                  <option value="square" selected>Square</option>
                  <option value="sine">Sine</option>
                  <option value="sawtooth">Saw</option>
                </select>
              </div>
              <div class="midi-fx-control">
                <label for="bass-sub-level">Sub Lvl <span class="fx-val" id="bass-sub-level-val">0.50</span></label>
                <input type="range" id="bass-sub-level" min="0" max="1" step="0.01" value="0.5" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-cutoff">Cutoff <span class="fx-val" id="bass-cutoff-val">1200</span></label>
                <input type="range" id="bass-cutoff" min="20" max="8000" step="10" value="1200" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-reso">Reso <span class="fx-val" id="bass-reso-val">8.0</span></label>
                <input type="range" id="bass-reso" min="0" max="25" step="0.5" value="8" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-env-amt">Env Amt <span class="fx-val" id="bass-env-amt-val">3000</span></label>
                <input type="range" id="bass-env-amt" min="0" max="10000" step="50" value="3000" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-env-decay">Env Dec <span class="fx-val" id="bass-env-decay-val">0.25</span></label>
                <input type="range" id="bass-env-decay" min="0.01" max="2" step="0.01" value="0.25" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-glide">Glide <span class="fx-val" id="bass-glide-val">0.06</span></label>
                <input type="range" id="bass-glide" min="0" max="0.5" step="0.01" value="0.06" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-octave">Octave <span class="fx-val" id="bass-octave-val">0</span></label>
                <input type="range" id="bass-octave" min="-2" max="2" step="1" value="0" />
              </div>
              <div class="midi-fx-control">
                <label for="bass-volume">Volume <span class="fx-val" id="bass-volume-val">0.70</span></label>
                <input type="range" id="bass-volume" min="0" max="1" step="0.01" value="0.7" />
              </div>
              <div class="midi-fx-control bass-accent-ctrl">
                <label for="bass-accent">Accent</label>
                <input type="checkbox" id="bass-accent" />
              </div>
            </div>
          </div>
        </div>

        <!-- MIDI Effects Drawer -->
        <div id="midi-effects-drawer" style="display:none;">
          <button id="midi-drawer-toggle" class="midi-drawer-handle" aria-label="Toggle effects drawer">
            <span class="midi-drawer-handle-bar"></span>
            <span class="midi-drawer-label">Effects</span>
            <span class="midi-drawer-chevron">‚ñº</span>
          </button>
          <div id="midi-drawer-content" class="midi-drawer-content">
            <div class="midi-fx-row">

              <!-- Waveform & Octave -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Synth</div>
                <div class="midi-fx-control">
                  <label for="fx-synth-preset">Preset</label>
                  <select id="fx-synth-preset">
                    <option value="">‚Äî Custom ‚Äî</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-waveform">Wave</label>
                  <select id="fx-waveform">
                    <option value="sawtooth">Saw</option>
                    <option value="square">Square</option>
                    <option value="sine">Sine</option>
                    <option value="triangle">Tri</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-octave">Octave <span class="fx-val" id="fx-val-octave">0</span></label>
                  <input type="range" id="fx-octave" min="-2" max="2" step="1" value="0" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-volume">Volume <span class="fx-val" id="fx-val-volume">0.50</span></label>
                  <input type="range" id="fx-volume" min="0" max="1" step="0.01" value="0.5" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- ADSR -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">ADSR</div>
                <div class="midi-fx-control">
                  <label for="fx-attack">Atk <span class="fx-val" id="fx-val-attack">0.05</span></label>
                  <input type="range" id="fx-attack" min="0.001" max="1.0" step="0.005" value="0.05" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-decay">Dec <span class="fx-val" id="fx-val-decay">0.15</span></label>
                  <input type="range" id="fx-decay" min="0.01" max="1.5" step="0.01" value="0.15" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-sustain">Sus <span class="fx-val" id="fx-val-sustain">0.60</span></label>
                  <input type="range" id="fx-sustain" min="0" max="1" step="0.01" value="0.6" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-release">Rel <span class="fx-val" id="fx-val-release">0.30</span></label>
                  <input type="range" id="fx-release" min="0.01" max="3.0" step="0.01" value="0.3" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Scale Lock -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Scale</div>
                <div class="midi-fx-control midi-fx-toggle-row">
                  <label for="fx-scale-toggle">Lock</label>
                  <input type="checkbox" id="fx-scale-toggle" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-scale-root">Root</label>
                  <select id="fx-scale-root">
                    <option value="0">C</option>
                    <option value="1">C‚ôØ</option>
                    <option value="2">D</option>
                    <option value="3">D‚ôØ</option>
                    <option value="4">E</option>
                    <option value="5">F</option>
                    <option value="6">F‚ôØ</option>
                    <option value="7">G</option>
                    <option value="8">G‚ôØ</option>
                    <option value="9">A</option>
                    <option value="10">A‚ôØ</option>
                    <option value="11">B</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-scale-type">Type</label>
                  <select id="fx-scale-type">
                    <option value="major">Major</option>
                    <option value="minor">Minor</option>
                    <option value="pentatonic">Pentatonic</option>
                    <option value="blues">Blues</option>
                    <option value="dorian">Dorian</option>
                    <option value="mixolydian">Mixolydian</option>
                  </select>
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Chord Mode -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Chord</div>
                <div class="midi-fx-control midi-fx-toggle-row">
                  <label for="fx-chord-toggle">Enable</label>
                  <input type="checkbox" id="fx-chord-toggle" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-chord-type">Type</label>
                  <select id="fx-chord-type">
                    <option value="major">Major</option>
                    <option value="minor">Minor</option>
                    <option value="7th">7th</option>
                    <option value="min7">Min 7</option>
                    <option value="sus4">Sus4</option>
                    <option value="power">Power</option>
                    <option value="dim">Dim</option>
                  </select>
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Arpeggiator -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Arp</div>
                <div class="midi-fx-control midi-fx-toggle-row">
                  <label for="fx-arp-toggle">Enable</label>
                  <input type="checkbox" id="fx-arp-toggle" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-arp-pattern">Pattern</label>
                  <select id="fx-arp-pattern">
                    <option value="up">Up</option>
                    <option value="down">Down</option>
                    <option value="updown">Up-Down</option>
                    <option value="random">Random</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-arp-rate">Rate</label>
                  <select id="fx-arp-rate">
                    <option value="1/4">1/4</option>
                    <option value="1/8" selected>1/8</option>
                    <option value="1/16">1/16</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-arp-bpm">BPM <span class="fx-val" id="fx-val-arp-bpm">120</span></label>
                  <input type="range" id="fx-arp-bpm" min="60" max="240" step="1" value="120" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-arp-octaves">Oct <span class="fx-val" id="fx-val-arp-oct">1</span></label>
                  <input type="range" id="fx-arp-octaves" min="1" max="3" step="1" value="1" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Filter -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Filter</div>
                <div class="midi-fx-control">
                  <label for="fx-filter-type">Type</label>
                  <select id="fx-filter-type">
                    <option value="lowpass" selected>LP</option>
                    <option value="highpass">HP</option>
                    <option value="bandpass">BP</option>
                  </select>
                </div>
                <div class="midi-fx-control">
                  <label for="fx-filter-cutoff">Cutoff <span class="fx-val" id="fx-val-cutoff">8000</span></label>
                  <input type="range" id="fx-filter-cutoff" min="50" max="16000" step="10" value="8000" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-filter-q">Reso <span class="fx-val" id="fx-val-q">1.0</span></label>
                  <input type="range" id="fx-filter-q" min="0.1" max="20" step="0.1" value="1" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Distortion -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Distortion</div>
                <div class="midi-fx-control">
                  <label for="fx-distortion">Drive <span class="fx-val" id="fx-val-drive">0.0</span></label>
                  <input type="range" id="fx-distortion" min="0" max="1" step="0.01" value="0" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Wah-Wah -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Wah-Wah</div>
                <div class="midi-fx-control midi-fx-toggle-row">
                  <label for="fx-wah-toggle">Enable</label>
                  <input type="checkbox" id="fx-wah-toggle" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-wah-rate">Rate <span class="fx-val" id="fx-val-wah-rate">2.0</span></label>
                  <input type="range" id="fx-wah-rate" min="0.1" max="12" step="0.1" value="2" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-wah-depth">Depth <span class="fx-val" id="fx-val-wah-depth">4000</span></label>
                  <input type="range" id="fx-wah-depth" min="100" max="8000" step="50" value="4000" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-wah-base">Base <span class="fx-val" id="fx-val-wah-base">500</span></label>
                  <input type="range" id="fx-wah-base" min="100" max="3000" step="20" value="500" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Delay -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Delay</div>
                <div class="midi-fx-control">
                  <label for="fx-delay-time">Time <span class="fx-val" id="fx-val-delay-time">0.30</span></label>
                  <input type="range" id="fx-delay-time" min="0.01" max="1.5" step="0.01" value="0.3" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-delay-feedback">Feed <span class="fx-val" id="fx-val-delay-fb">0.30</span></label>
                  <input type="range" id="fx-delay-feedback" min="0" max="0.9" step="0.01" value="0.3" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-delay-mix">Mix <span class="fx-val" id="fx-val-delay-mix">0.00</span></label>
                  <input type="range" id="fx-delay-mix" min="0" max="1" step="0.01" value="0" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Reverb -->
              <div class="midi-fx-group">
                <div class="midi-fx-title">Reverb</div>
                <div class="midi-fx-control">
                  <label for="fx-reverb-mix">Mix <span class="fx-val" id="fx-val-reverb-mix">0.00</span></label>
                  <input type="range" id="fx-reverb-mix" min="0" max="1" step="0.01" value="0" />
                </div>
                <div class="midi-fx-control">
                  <label for="fx-reverb-decay">Decay <span class="fx-val" id="fx-val-reverb-decay">1.50</span></label>
                  <input type="range" id="fx-reverb-decay" min="0.3" max="5" step="0.1" value="1.5" />
                </div>
              </div>

              <div class="midi-fx-divider"></div>

              <!-- Looper -->
              <div class="midi-fx-group midi-fx-looper">
                <div class="midi-fx-title">Looper</div>
                <div class="midi-looper-controls">
                  <button id="fx-looper-rec" class="midi-looper-btn midi-looper-rec" title="Record">‚è∫</button>
                  <button id="fx-looper-play" class="midi-looper-btn midi-looper-play" title="Play/Pause"
                    disabled>‚ñ∂</button>
                  <button id="fx-looper-stop" class="midi-looper-btn midi-looper-stop" title="Clear" disabled>‚èπ</button>
                </div>
                <div class="midi-looper-status" id="fx-looper-status">Idle</div>
              </div>

            </div>
          </div>
        </div>

        <!-- Visual FX Drawer -->
        <div id="vfx-drawer" style="display:none;">
          <button id="vfx-drawer-toggle" class="midi-drawer-handle vfx-drawer-handle"
            aria-label="Toggle visual effects drawer">
            <span class="midi-drawer-handle-bar"></span>
            <span class="midi-drawer-label">üé® Visual FX</span>
            <span class="midi-drawer-handle-bar"></span>
          </button>
          <div id="vfx-drawer-content" class="midi-drawer-content">
            <div class="midi-fx-row">
              <div class="midi-fx-group midi-fx-visualfx">
                <div id="shader-layers"></div>
                <div class="shader-layer-actions">
                  <button id="shader-add-layer" class="shader-btn" title="Add Layer">+ Layer</button>
                  <button id="shader-paste-glsl" class="shader-btn" title="Paste Shadertoy GLSL">üìã Paste GLSL</button>
                </div>
                <div id="custom-shader-library" style="display:none;">
                  <div class="shader-library-header">
                    <span class="shader-library-label">Saved</span>
                  </div>
                  <div id="custom-shader-list"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Paste GLSL Modal -->
          <dialog id="glsl-paste-modal" class="glsl-modal">
            <div class="glsl-modal-content">
              <h3>Import Shader</h3>
              <p>Paste GLSL from Shadertoy or write your own. Shadertoy's <code>mainImage()</code> format is
                auto-detected.</p>
              <label for="glsl-paste-name">Name</label>
              <input type="text" id="glsl-paste-name" placeholder="my-shader" />
              <label for="glsl-paste-code">GLSL Code</label>
              <textarea id="glsl-paste-code" rows="12" spellcheck="false"
                placeholder="void mainImage(out vec4 fragColor, in vec2 fragCoord) {&#10;    vec2 uv = fragCoord / iResolution.xy;&#10;    fragColor = vec4(uv, 0.5, 1.0);&#10;}"></textarea>
              <div id="glsl-paste-error" class="glsl-error"></div>
              <div class="glsl-modal-buttons">
                <button id="glsl-paste-cancel" class="shader-btn">Cancel</button>
                <button id="glsl-paste-import" class="shader-btn shader-btn-primary">Import</button>
              </div>
            </div>
          </dialog>
        </div>
      </div>
      <div id="fps-counter">0 FPS</div>
    </main>

    <!-- Control Panel -->
    <aside id="panel">
      <header id="panel-header">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;">
          <div>
            <h1>Fractal Generator</h1>
            <p class="subtitle" id="attractor-subtitle">Strange Attractors</p>
          </div>
          <button id="touch-mode-btn" class="btn btn-sm" title="Toggle Touch Mode (iPad)"
            style="flex-shrink:0;font-size:16px;padding:4px 8px;line-height:1;">
            üëÜ
          </button>
        </div>
      </header>

      <div id="panel-scroll">
        <!-- Seed Section -->
        <section class="panel-section">
          <h2 class="section-title">Seed</h2>
          <div class="seed-display" id="seed-display">12345</div>
          <div class="seed-nav">
            <button id="seed-prev" class="btn btn-sm" title="Previous">‚óÄ</button>
            <button id="seed-next" class="btn btn-sm" title="Next">‚ñ∂</button>
            <button id="seed-random" class="btn btn-sm btn-accent" title="Random">‚ö°</button>
          </div>
          <div class="seed-jump">
            <label for="seed-input" class="sr-only">Jump to seed</label>
            <input type="number" id="seed-input" placeholder="Jump to seed..." />
            <button id="seed-go" class="btn btn-sm">Go</button>
          </div>
        </section>

        <!-- Attractor Type Section -->
        <section class="panel-section">
          <h2 class="section-title">Attractor Type</h2>
          <div class="control-group">
            <label for="attractor-type" class="sr-only">Attractor type</label>
            <select id="attractor-type">
              <option value="dejong" selected>ü¶ã Peter de Jong</option>
              <option value="clifford">üåä Clifford</option>
              <option value="lorenz">üåÄ Lorenz</option>
              <option value="aizawa">üîÆ Aizawa</option>
              <option value="buddhabrot">üëª Buddhabrot</option>
              <option value="burningship">üî• Burning Ship</option>
              <option value="mandelbrot">üåÄ Mandelbrot / Julia</option>
              <option value="curlnoise">üå´Ô∏è Curl Noise</option>
            </select>
          </div>
        </section>

        <!-- Canvas Size Section -->
        <section class="panel-section">
          <h2 class="section-title">Canvas Size</h2>
          <div class="control-group">
            <label for="canvas-aspect" class="sr-only">Canvas aspect ratio</label>
            <select id="canvas-aspect">
              <option value="1:1">‚¨ú 1 : 1 (Square)</option>
              <option value="16:9" selected>üñ•Ô∏è 16 : 9 (Landscape)</option>
              <option value="9:16">üì± 9 : 16 (Portrait)</option>
            </select>
          </div>
        </section>

        <!-- Symmetry Section -->
        <section class="panel-section">
          <h2 class="section-title">Symmetry</h2>
          <div class="control-group">
            <label for="symmetry-folds" class="sr-only">Symmetry folds</label>
            <select id="symmetry-folds">
              <option value="1" selected>üî≤ Off</option>
              <option value="2">ü™û 2-fold</option>
              <option value="4">‚ú¶ 4-fold</option>
              <option value="6">‚ùÑÔ∏è 6-fold</option>
              <option value="8">‚ú¥Ô∏è 8-fold</option>
            </select>
          </div>
        </section>

        <!-- Presets Section -->
        <section class="panel-section">
          <h2 class="section-title">Presets</h2>
          <div id="presets-grid" class="presets-grid"></div>
        </section>

        <!-- De Jong Coefficients -->
        <section class="panel-section" id="dejong-coeffs">
          <h2 class="section-title">Coefficients (a, b, c, d)</h2>
          <div class="control-group">
            <label for="coeff-a">a <span class="value-display" id="val-a">-2.24</span></label>
            <input type="range" id="coeff-a" min="-3.14" max="3.14" step="0.01" value="-2.24" />
          </div>
          <div class="control-group">
            <label for="coeff-b">b <span class="value-display" id="val-b">0.43</span></label>
            <input type="range" id="coeff-b" min="-3.14" max="3.14" step="0.01" value="0.43" />
          </div>
          <div class="control-group">
            <label for="coeff-c">c <span class="value-display" id="val-c">-0.65</span></label>
            <input type="range" id="coeff-c" min="-3.14" max="3.14" step="0.01" value="-0.65" />
          </div>
          <div class="control-group">
            <label for="coeff-d">d <span class="value-display" id="val-d">-2.43</span></label>
            <input type="range" id="coeff-d" min="-3.14" max="3.14" step="0.01" value="-2.43" />
          </div>
          <button id="randomize-btn" class="btn btn-full btn-accent">‚ö° Randomize</button>
        </section>

        <!-- Lorenz Coefficients -->
        <section class="panel-section" id="lorenz-coeffs" style="display:none;">
          <h2 class="section-title">Coefficients (œÉ, œÅ, Œ≤)</h2>
          <div class="control-group">
            <label for="coeff-sigma">œÉ (sigma) <span class="value-display" id="val-sigma">10.00</span></label>
            <input type="range" id="coeff-sigma" min="0" max="30" step="0.1" value="10" />
          </div>
          <div class="control-group">
            <label for="coeff-rho">œÅ (rho) <span class="value-display" id="val-rho">28.00</span></label>
            <input type="range" id="coeff-rho" min="0" max="120" step="0.1" value="28" />
          </div>
          <div class="control-group">
            <label for="coeff-beta">Œ≤ (beta) <span class="value-display" id="val-beta">2.67</span></label>
            <input type="range" id="coeff-beta" min="0" max="10" step="0.01" value="2.667" />
          </div>
          <button id="randomize-lorenz-btn" class="btn btn-full btn-accent">‚ö° Randomize</button>
        </section>

        <!-- Clifford Coefficients -->
        <section class="panel-section" id="clifford-coeffs" style="display:none;">
          <h2 class="section-title">Coefficients (a, b, c, d)</h2>
          <div class="control-group">
            <label for="coeff-cliff-a">a <span class="value-display" id="val-cliff-a">-1.40</span></label>
            <input type="range" id="coeff-cliff-a" min="-3" max="3" step="0.01" value="-1.4" />
          </div>
          <div class="control-group">
            <label for="coeff-cliff-b">b <span class="value-display" id="val-cliff-b">1.60</span></label>
            <input type="range" id="coeff-cliff-b" min="-3" max="3" step="0.01" value="1.6" />
          </div>
          <div class="control-group">
            <label for="coeff-cliff-c">c <span class="value-display" id="val-cliff-c">1.00</span></label>
            <input type="range" id="coeff-cliff-c" min="-2" max="2" step="0.01" value="1.0" />
          </div>
          <div class="control-group">
            <label for="coeff-cliff-d">d <span class="value-display" id="val-cliff-d">0.70</span></label>
            <input type="range" id="coeff-cliff-d" min="-2" max="2" step="0.01" value="0.7" />
          </div>
          <button id="randomize-clifford-btn" class="btn btn-full btn-accent">‚ö° Randomize</button>
        </section>

        <!-- Aizawa Coefficients -->
        <section class="panel-section" id="aizawa-coeffs" style="display:none;">
          <h2 class="section-title">Coefficients (a, b, c, d, e, f)</h2>
          <div class="control-group">
            <label for="coeff-aiz-a">a <span class="value-display" id="val-aiz-a">0.95</span></label>
            <input type="range" id="coeff-aiz-a" min="0.1" max="2.0" step="0.01" value="0.95" />
          </div>
          <div class="control-group">
            <label for="coeff-aiz-b">b <span class="value-display" id="val-aiz-b">0.70</span></label>
            <input type="range" id="coeff-aiz-b" min="0.1" max="1.5" step="0.01" value="0.7" />
          </div>
          <div class="control-group">
            <label for="coeff-aiz-c">c <span class="value-display" id="val-aiz-c">0.60</span></label>
            <input type="range" id="coeff-aiz-c" min="0.1" max="1.5" step="0.01" value="0.6" />
          </div>
          <div class="control-group">
            <label for="coeff-aiz-d">d <span class="value-display" id="val-aiz-d">3.50</span></label>
            <input type="range" id="coeff-aiz-d" min="1.0" max="6.0" step="0.1" value="3.5" />
          </div>
          <div class="control-group">
            <label for="coeff-aiz-e">e <span class="value-display" id="val-aiz-e">0.25</span></label>
            <input type="range" id="coeff-aiz-e" min="0.01" max="1.0" step="0.01" value="0.25" />
          </div>
          <div class="control-group">
            <label for="coeff-aiz-f">f <span class="value-display" id="val-aiz-f">0.10</span></label>
            <input type="range" id="coeff-aiz-f" min="0.01" max="0.5" step="0.01" value="0.1" />
          </div>
          <button id="randomize-aizawa-btn" class="btn btn-full btn-accent">‚ö° Randomize</button>
        </section>

        <!-- Buddhabrot Controls -->
        <section class="panel-section" id="buddhabrot-coeffs" style="display:none;">
          <h2 class="section-title">Parameters</h2>
          <div class="control-group">
            <label for="bb-maxiter">Max Iterations <span class="value-display" id="val-bb-maxiter">200</span></label>
            <input type="range" id="bb-maxiter" min="10" max="5000" step="10" value="200" />
          </div>
          <div class="control-group">
            <label for="bb-samples">Samples <span class="value-display" id="val-bb-samples">500K</span></label>
            <input type="range" id="bb-samples" min="4" max="6.5" step="0.1" value="5.7" />
          </div>
          <div class="control-group toggle-row">
            <label for="bb-anti">Anti-Buddhabrot</label>
            <input type="checkbox" id="bb-anti" />
          </div>
          <div class="control-group">
            <label for="bb-zoom">Zoom <span class="value-display" id="val-bb-zoom">1.00</span></label>
            <input type="range" id="bb-zoom" min="0.3" max="8" step="0.1" value="1.0" />
          </div>
          <div class="control-group">
            <label for="bb-center-x">Center X <span class="value-display" id="val-bb-cx">-0.50</span></label>
            <input type="range" id="bb-center-x" min="-2" max="1" step="0.01" value="-0.5" />
          </div>
          <div class="control-group">
            <label for="bb-center-y">Center Y <span class="value-display" id="val-bb-cy">0.00</span></label>
            <input type="range" id="bb-center-y" min="-1.5" max="1.5" step="0.01" value="0" />
          </div>
        </section>

        <!-- Burning Ship Controls -->
        <section class="panel-section" id="burningship-coeffs" style="display:none;">
          <h2 class="section-title">Parameters</h2>
          <div class="control-group">
            <label for="bs-maxiter">Max Iterations <span class="value-display" id="val-bs-maxiter">200</span></label>
            <input type="range" id="bs-maxiter" min="10" max="5000" step="10" value="200" />
          </div>
          <div class="control-group">
            <label for="bs-samples">Samples <span class="value-display" id="val-bs-samples">500K</span></label>
            <input type="range" id="bs-samples" min="4" max="6.5" step="0.1" value="5.7" />
          </div>
          <div class="control-group toggle-row">
            <label for="bs-anti">Anti-Ship</label>
            <input type="checkbox" id="bs-anti" />
          </div>
          <div class="control-group">
            <label for="bs-zoom">Zoom <span class="value-display" id="val-bs-zoom">1.00</span></label>
            <input type="range" id="bs-zoom" min="0.3" max="8" step="0.1" value="1.0" />
          </div>
          <div class="control-group">
            <label for="bs-center-x">Center X <span class="value-display" id="val-bs-cx">-0.40</span></label>
            <input type="range" id="bs-center-x" min="-2" max="1" step="0.01" value="-0.4" />
          </div>
          <div class="control-group">
            <label for="bs-center-y">Center Y <span class="value-display" id="val-bs-cy">-0.60</span></label>
            <input type="range" id="bs-center-y" min="-1.5" max="1.5" step="0.01" value="-0.6" />
          </div>
        </section>

        <!-- Mandelbrot / Julia Controls -->
        <section class="panel-section" id="mandelbrot-coeffs" style="display:none;">
          <h2 class="section-title">Parameters</h2>
          <div class="control-group">
            <label for="mb-maxiter">Max Iterations <span class="value-display" id="val-mb-maxiter">256</span></label>
            <input type="range" id="mb-maxiter" min="50" max="2000" step="10" value="256" />
          </div>
          <div class="control-group">
            <label for="mb-zoom">Zoom <span class="value-display" id="val-mb-zoom">1.00</span></label>
            <input type="range" id="mb-zoom" min="0" max="100" step="0.1" value="5.4" />
          </div>
          <div class="control-group">
            <label for="mb-center-x">Center X <span class="value-display" id="val-mb-cx">-0.50</span></label>
            <input type="range" id="mb-center-x" min="-2.5" max="1.5" step="0.001" value="-0.5" />
          </div>
          <div class="control-group">
            <label for="mb-center-y">Center Y <span class="value-display" id="val-mb-cy">0.00</span></label>
            <input type="range" id="mb-center-y" min="-1.5" max="1.5" step="0.001" value="0" />
          </div>
          <div class="control-group toggle-row">
            <label for="mb-julia">Julia Mode</label>
            <input type="checkbox" id="mb-julia" />
          </div>
          <div class="control-group" id="mb-julia-params" style="display:none;">
            <label for="mb-julia-r">Julia Re <span class="value-display" id="val-mb-jr">-0.70</span></label>
            <input type="range" id="mb-julia-r" min="-2" max="2" step="0.001" value="-0.7" />
          </div>
          <div class="control-group" id="mb-julia-params-i" style="display:none;">
            <label for="mb-julia-i">Julia Im <span class="value-display" id="val-mb-ji">0.27</span></label>
            <input type="range" id="mb-julia-i" min="-2" max="2" step="0.001" value="0.27015" />
          </div>
          <button class="action-btn" id="randomize-mandelbrot-btn">üé≤ Randomize</button>
        </section>

        <!-- Curl Noise Controls -->
        <section class="panel-section" id="curlnoise-coeffs" style="display:none;">
          <h2 class="section-title">Flow Field Parameters</h2>
          <div class="control-group">
            <label for="cn-scale">Noise Scale <span class="value-display" id="val-cn-scale">1.50</span></label>
            <input type="range" id="cn-scale" min="0.3" max="5.0" step="0.1" value="1.5" />
          </div>
          <div class="control-group">
            <label for="cn-octaves">Octaves <span class="value-display" id="val-cn-octaves">4</span></label>
            <input type="range" id="cn-octaves" min="1" max="8" step="1" value="4" />
          </div>
          <div class="control-group">
            <label for="cn-lacunarity">Lacunarity <span class="value-display" id="val-cn-lacunarity">2.00</span></label>
            <input type="range" id="cn-lacunarity" min="1.0" max="4.0" step="0.1" value="2.0" />
          </div>
          <div class="control-group">
            <label for="cn-gain">Gain <span class="value-display" id="val-cn-gain">0.50</span></label>
            <input type="range" id="cn-gain" min="0.1" max="0.9" step="0.05" value="0.5" />
          </div>
          <div class="control-group">
            <label for="cn-speed">Speed <span class="value-display" id="val-cn-speed">0.50</span></label>
            <input type="range" id="cn-speed" min="0.05" max="2.0" step="0.05" value="0.5" />
          </div>
          <button id="randomize-curlnoise-btn" class="btn btn-full btn-accent">‚ö° Randomize</button>
        </section>

        <!-- Render Mode Section -->
        <section class="panel-section">
          <h2 class="section-title">Render Mode</h2>
          <div class="control-group">
            <label for="render-mode" class="sr-only">Render mode</label>
            <select id="render-mode">
              <option value="classic" selected>üé® Classic (Density)</option>
              <option value="particles">‚ú® Particles</option>
              <option value="vapor">üå´Ô∏è Vapor</option>
            </select>
          </div>

          <!-- Classic sub-controls -->
          <div id="classic-controls" class="sub-controls">
            <div class="control-group">
              <label for="iterations">Iterations <span class="value-display" id="val-iterations">500K</span></label>
              <input type="range" id="iterations" min="4" max="7" step="0.1" value="5.7" />
            </div>
            <div class="control-group">
              <label for="density-mode">Density Map</label>
              <select id="density-mode">
                <option value="sqrt" selected>Square Root</option>
                <option value="log">Logarithmic</option>
                <option value="linear">Linear</option>
              </select>
            </div>
          </div>

          <!-- Particle sub-controls -->
          <div id="particle-controls" class="sub-controls" style="display:none;">
            <div class="control-group">
              <label for="particle-count">Particle Count <span class="value-display" id="val-pcount">2000</span></label>
              <input type="range" id="particle-count" min="200" max="8000" step="100" value="2000" />
            </div>
            <div class="control-group">
              <label for="trail-length">Trail Length <span class="value-display" id="val-trail">0.92</span></label>
              <input type="range" id="trail-length" min="0.5" max="0.99" step="0.01" value="0.92" />
            </div>
            <div class="control-group">
              <label for="glow-intensity">Glow Intensity <span class="value-display" id="val-glow">1.5</span></label>
              <input type="range" id="glow-intensity" min="0" max="4" step="0.1" value="1.5" />
            </div>
            <div class="control-group">
              <label for="particle-size">Point Size <span class="value-display" id="val-psize">2.0</span></label>
              <input type="range" id="particle-size" min="0.5" max="6" step="0.1" value="2.0" />
            </div>
          </div>

          <!-- Vapor sub-controls -->
          <div id="vapor-controls" class="sub-controls" style="display:none;">
            <div class="control-group">
              <label for="vapor-count">Particle Count <span class="value-display" id="val-vpcount">3000</span></label>
              <input type="range" id="vapor-count" min="500" max="10000" step="100" value="3000" />
            </div>
            <div class="control-group">
              <label for="blur-passes">Blur Passes <span class="value-display" id="val-blur">3</span></label>
              <input type="range" id="blur-passes" min="0" max="8" step="1" value="3" />
            </div>
            <div class="control-group">
              <label for="turbulence">Turbulence <span class="value-display" id="val-turb">0.4</span></label>
              <input type="range" id="turbulence" min="0" max="1" step="0.01" value="0.4" />
            </div>
            <div class="control-group">
              <label for="dissipation">Dissipation <span class="value-display" id="val-dissipation">0.96</span></label>
              <input type="range" id="dissipation" min="0.85" max="0.99" step="0.01" value="0.96" />
            </div>
          </div>
        </section>

        <!-- Colors Section -->
        <section class="panel-section">
          <h2 class="section-title">Colors</h2>
          <div class="control-group">
            <label for="color-mode">Color Mode</label>
            <select id="color-mode">
              <option value="spectral" selected>üåà Spectral</option>
              <option value="dual">üé≠ Dual Blend</option>
              <option value="vivid">üîÆ Vivid (Multi-Gradient)</option>
              <option value="single">üîµ Single Color</option>
            </select>
          </div>
          <div id="color-pickers" class="color-picker-row">
            <div class="control-group">
              <label for="color-a">Color A</label>
              <input type="color" id="color-a" value="#00d4ff" />
            </div>
            <div class="control-group">
              <label for="color-b">Color B</label>
              <input type="color" id="color-b" value="#ff006e" />
            </div>
          </div>
          <div class="control-group">
            <label for="bg-color">Background</label>
            <input type="color" id="bg-color" value="#0a0a0f" />
          </div>
          <div class="control-group" id="blend-mode-group" style="display:none;">
            <label for="blend-mode">Blend Mode</label>
            <select id="blend-mode">
              <option value="normal" selected>üé® Normal</option>
              <option value="add">‚ú® Additive</option>
            </select>
          </div>
          <div class="palette-section">
            <label class="palette-label">Palettes</label>
            <div id="palette-grid" class="palette-grid"></div>
          </div>
        </section>

        <!-- Diffusion Section -->
        <section class="panel-section">
          <h2 class="section-title">Diffusion</h2>
          <div class="control-group toggle-row">
            <label for="diffusion-toggle">Enable</label>
            <input type="checkbox" id="diffusion-toggle" />
          </div>
          <div class="control-group">
            <label for="diffusion-strength">Strength <span class="value-display" id="val-diffusion">1.5</span></label>
            <input type="range" id="diffusion-strength" min="0.5" max="5" step="0.1" value="1.5" />
          </div>
        </section>

        <!-- Mouse Interaction Section -->
        <section class="panel-section">
          <h2 class="section-title">Mouse Interaction</h2>
          <div class="control-group toggle-row">
            <label for="mouse-toggle">Enable</label>
            <input type="checkbox" id="mouse-toggle" />
          </div>
          <div class="control-group">
            <label for="mouse-strength">Strength <span class="value-display" id="val-mouse-strength">0.50</span></label>
            <input type="range" id="mouse-strength" min="0.05" max="2.0" step="0.05" value="0.5" />
          </div>
          <div class="control-group">
            <label for="mouse-mode">Mode</label>
            <select id="mouse-mode">
              <option value="attract" selected>üß≤ Attract</option>
              <option value="repel">üí• Repel</option>
              <option value="orbit">üåÄ Orbit</option>
            </select>
          </div>
        </section>

        <!-- Animation Section -->
        <section class="panel-section">
          <h2 class="section-title">Animation</h2>
          <div class="control-group toggle-row">
            <label for="auto-animate">Auto Animate</label>
            <input type="checkbox" id="auto-animate" checked />
          </div>
          <div class="control-group">
            <label for="anim-speed">Speed <span class="value-display" id="val-speed">0.003</span></label>
            <input type="range" id="anim-speed" min="0.0005" max="0.02" step="0.0005" value="0.003" />
          </div>
          <div class="anim-controls">
            <button id="btn-play" class="btn btn-sm btn-accent">‚ñ∂ Play</button>
            <button id="btn-pause" class="btn btn-sm" style="display:none">‚è∏ Pause</button>
          </div>
        </section>

        <!-- Audio Reactive Section -->
        <section class="panel-section">
          <h2 class="section-title">Audio Reactive</h2>
          <div class="audio-status-row">
            <span class="audio-status-dot" id="audio-status-dot"></span>
            <span class="audio-status-text" id="audio-status-text">Off</span>
          </div>
          <button id="btn-listen" class="btn btn-full btn-accent">üé§ Listen</button>
          <button id="btn-stop-listen" class="btn btn-full btn-danger" style="display:none">‚èπ Stop Listening</button>
          <canvas id="audio-visualizer" width="280" height="40"></canvas>
          <div class="control-group" style="margin-top: 10px;">
            <label for="audio-sensitivity">Sensitivity <span class="value-display"
                id="val-sensitivity">1.00</span></label>
            <input type="range" id="audio-sensitivity" min="0.1" max="3.0" step="0.05" value="1.0" />
          </div>
          <div class="control-group" style="margin-top: 10px;">
            <label>
              <input type="checkbox" id="waveform-toggle" /> Waveform Overlay
            </label>
          </div>
          <div class="control-group" id="waveform-style-group" style="display:none; margin-top: 6px;">
            <label for="waveform-style">Style</label>
            <select id="waveform-style">
              <option value="oscilloscope">Oscilloscope</option>
              <option value="mirrored">Mirrored</option>
              <option value="circular">Circular</option>
              <option value="bars">Bars</option>
              <option value="radial">Radial</option>
            </select>
          </div>
          <div class="control-group" id="waveform-intensity-group" style="display:none; margin-top: 6px;">
            <label for="waveform-intensity">Intensity <span class="value-display"
                id="val-waveform-intensity">0.70</span></label>
            <input type="range" id="waveform-intensity" min="0.1" max="1.0" step="0.05" value="0.7" />
          </div>

          <!-- MIDI Keyboard -->
          <div class="control-group midi-section"
            style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border);">
            <label for="midi-toggle">MIDI Keyboard</label>
            <div class="midi-toggle-row">
              <input type="checkbox" id="midi-toggle" />
              <span class="midi-status-dot" id="midi-status-dot"></span>
              <span class="midi-status-text" id="midi-status-text">Off</span>
            </div>
          </div>
          <div id="midi-controls" style="display:none">
            <div class="control-group">
              <label for="midi-waveform">Waveform</label>
              <select id="midi-waveform">
                <option value="sawtooth">üî∂ Sawtooth</option>
                <option value="square">‚¨õ Square</option>
                <option value="sine">üîµ Sine</option>
                <option value="triangle">üî∫ Triangle</option>
              </select>
            </div>
            <div class="control-group">
              <label>Device <span class="value-display" id="midi-device-name">‚Äî</span></label>
            </div>
          </div>

          <!-- Guitar Simulator -->
          <div class="control-group guitar-section"
            style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border);">
            <label for="guitar-toggle">üé∏ Guitar</label>
            <div class="midi-toggle-row">
              <input type="checkbox" id="guitar-toggle" />
              <span class="midi-status-dot" id="guitar-status-dot"></span>
              <span class="midi-status-text" id="guitar-status-text">Off</span>
            </div>
          </div>
        </section>

        <!-- Post-Processing Section -->
        <section class="panel-section">
          <h2 class="section-title">Post-Processing</h2>

          <div class="control-group toggle-row">
            <label for="pp-bloom">Bloom</label>
            <input type="checkbox" id="pp-bloom" />
          </div>
          <div class="control-group">
            <label for="pp-bloom-strength">Strength <span class="value-display" id="val-pp-bloom">0.50</span></label>
            <input type="range" id="pp-bloom-strength" min="0" max="1" step="0.05" value="0.5" />
          </div>

          <div class="control-group toggle-row">
            <label for="pp-chromatic">Chromatic Aberration</label>
            <input type="checkbox" id="pp-chromatic" />
          </div>
          <div class="control-group">
            <label for="pp-chromatic-strength">Strength <span class="value-display"
                id="val-pp-chromatic">0.50</span></label>
            <input type="range" id="pp-chromatic-strength" min="0" max="1" step="0.05" value="0.5" />
          </div>

          <div class="control-group toggle-row">
            <label for="pp-vignette">Vignette</label>
            <input type="checkbox" id="pp-vignette" />
          </div>
          <div class="control-group">
            <label for="pp-vignette-strength">Strength <span class="value-display"
                id="val-pp-vignette">0.50</span></label>
            <input type="range" id="pp-vignette-strength" min="0" max="1" step="0.05" value="0.5" />
          </div>

          <div class="control-group toggle-row">
            <label for="pp-grain">Film Grain</label>
            <input type="checkbox" id="pp-grain" />
          </div>
          <div class="control-group">
            <label for="pp-grain-strength">Strength <span class="value-display" id="val-pp-grain">0.30</span></label>
            <input type="range" id="pp-grain-strength" min="0" max="1" step="0.05" value="0.3" />
          </div>

          <div class="control-group toggle-row">
            <label for="pp-scanlines">Scanlines</label>
            <input type="checkbox" id="pp-scanlines" />
          </div>
          <div class="control-group">
            <label for="pp-scanlines-strength">Strength <span class="value-display"
                id="val-pp-scanlines">0.40</span></label>
            <input type="range" id="pp-scanlines-strength" min="0" max="1" step="0.05" value="0.4" />
          </div>
        </section>

        <!-- Actions Section -->
        <section class="panel-section">
          <h2 class="section-title">Actions</h2>
          <button id="btn-save" class="btn btn-full">üì∑ Save PNG</button>
          <button id="btn-record" class="btn btn-full">üé¨ Record WebM</button>
          <button id="btn-stop-record" class="btn btn-full btn-danger" style="display:none">‚èπ Stop Recording</button>
          <button id="btn-reset" class="btn btn-full">üîÑ Reset</button>
        </section>


      </div>
    </aside>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>

</html>